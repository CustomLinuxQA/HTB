---
tags: [kb, vuln, idor, web]
---

# IDOR (Insecure Direct Object Reference)

## Что это
IDOR — уязвимость, при которой сервер **не проверяет права доступа** к объекту, а доверяет идентификатору из запроса (id, token, user_id и т.д.).

## Типичные признаки
- Параметры в URL или JSON:
  - `id=`
  - `user=`
  - `token=`
  - `account=`
- API возвращает JSON
- Ошибки вида:
  - `Missing parameter`
  - `Invalid token`
- Отсутствует явная авторизация

## Как проверять (быстро)
1. Найти endpoint с параметром
2. Менять значения:
   - `0`
   - `1`
   - `-1`
   - `999`
3. Проверять:
   - возвращаются ли чужие данные
   - меняется ли объём ответа

## Классические payload'ы
```text
?token=0
?id=1
?id=2
?id=999
```

⚠️ `0` — **особенно важно**, часто возвращает всё.

## Что можно получить

- Чужие данные (email, role, salary)
- Хеши паролей
- Полные списки пользователей
- Иногда — admin-доступ

## Почему это работает

- Проверка доступа на клиенте
- Отсутствие server-side authorization
- Ошибки обработки edge-case значений

## Когда особенно часто встречается

- Самописные API
- Старые PHP-приложения
- Внутренние endpoints (`/user`, `/profile`, `/api/users`)
## Связанные паттерны

- [[03-KB/Patterns/Enumerate-Params]]
- [[02-Playbooks/Web-Checklist]]